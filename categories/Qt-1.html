
<!DOCTYPE html>
<html lang="zh">
    <head>

        
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/svg+xml" href="/Phosphophyllite/favicon.svg">
        
        

        
        <title>PlanC 的博客 - Qt</title>
        <meta name="description" content="PlanC 的博客 - Qt 分类 - 第 1 页">
        

        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" >
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/nord.min.css" rel="stylesheet">
        <link href="/Phosphophyllite/css/normalize.css" rel="stylesheet">
        <link href="/Phosphophyllite/css/bootstrap-quartz-theme.min.css" rel="stylesheet">
        <link href="/Phosphophyllite/css/github-markdown.css" rel="stylesheet">
        <link href="/Phosphophyllite/css/custom.css" rel="stylesheet">
        <link href="/Phosphophyllite/css/custom-dark.css" rel="stylesheet">
        
        
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script src="/Phosphophyllite/js/custom.js"></script>
        

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-HEWPX7E6EV"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-HEWPX7E6EV');
        </script>

        <script>
            
            document.oncopy = makeOnCopy("PlanC");
            
        </script>
    </head>

    <body class="d-flex flex-column">
        

<nav class="navbar navbar-expand-lg card no-print" data-bs-theme="dark" style="border-radius: 0;">
    <div class="container-fluid">
        <span class="navbar-brand">PlanC 的博客</span>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarColor01">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link active" href="/Phosphophyllite/">首页</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="https://github.com/hubenchang0515" target="_blank">GitHub</a>
                </li>
            </ul>
            <form id='search-form' class="d-flex">
                <input id="search-input" name="q" class="form-control text-info me-sm-2" type="search" placeholder="Search" autocomplete="off">
            </form>
            <script>
                makeSearch("https://xplanc.org/Phosphophyllite", 'search-form', 'search-input')
            </script>
        </div>
    </div>
</nav>



        <div class="content d-flex flex-grow-1 m-2">
            <aside class="no-print left-side flex-shrink-0 d-flex flex-column"> 
            

<div class="card">
    <div class="card-body">
        <div style="margin: auto;">
            <img class="github-avatar" src="https://github.com/hubenchang0515.png"/>
            <h4 class="github-name card-title">PlanC</h4>
            <h6 class="github-username card-subtitle mb-2 text-muted">hubenchang0515</h6>
            <p class="github-brief card-text"></p>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <h4 class="card-title">文章分类</h4>
        <h6 class="card-subtitle mb-2 text-muted">Categories</h6>

        <div style="width: 100%;display: flex; flex-wrap: wrap; gap: 4px;">
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Linux%20%E5%91%BD%E4%BB%A4%E4%B8%8E%E9%85%8D%E7%BD%AE-1.html">
                <span>
                    Linux 命令与配置
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    18
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/FreeRTOS-1.html">
                <span>
                    FreeRTOS
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    10
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Qt-1.html">
                <span>
                    Qt
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    10
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Linux%20API-1.html">
                <span>
                    Linux API
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    9
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/%E4%BB%A3%E7%90%86%E4%B8%8E%E9%95%9C%E5%83%8F%E6%BA%90%E9%85%8D%E7%BD%AE-1.html">
                <span>
                    代理与镜像源配置
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    9
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB-1.html">
                <span>
                    默认分类
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    8
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/X11-1.html">
                <span>
                    X11
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    5
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/CUDA-1.html">
                <span>
                    CUDA
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    4
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/C%20%E8%AF%AD%E8%A8%80-1.html">
                <span>
                    C 语言
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/C%2B%2B-1.html">
                <span>
                    C++
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/CMake-1.html">
                <span>
                    CMake
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/MySQL-1.html">
                <span>
                    MySQL
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Python-1.html">
                <span>
                    Python
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Windows%20API-1.html">
                <span>
                    Windows API
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/%E6%B1%87%E7%BC%96-1.html">
                <span>
                    汇编
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    3
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Docker-1.html">
                <span>
                    Docker
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    2
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Minecraft-1.html">
                <span>
                    Minecraft
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    2
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/FreeType-1.html">
                <span>
                    FreeType
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/GitHub-1.html">
                <span>
                    GitHub
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/GitLab-1.html">
                <span>
                    GitLab
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Golang-1.html">
                <span>
                    Golang
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Kafka-1.html">
                <span>
                    Kafka
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/OpenCL-1.html">
                <span>
                    OpenCL
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/OpenGL-1.html">
                <span>
                    OpenGL
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/React-1.html">
                <span>
                    React
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/Windows%20%E5%91%BD%E4%BB%A4%E4%B8%8E%E9%85%8D%E7%BD%AE-1.html">
                <span>
                    Windows 命令与配置
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/nginx-1.html">
                <span>
                    nginx
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
            <a class="category-link link-underline link-underline-opacity-0" href="/Phosphophyllite/categories/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB-1.html">
                <span>
                    资源分享
                </span>
                <span style="flex: 1;"></span>
                <span class="badge" style="background-color: #ec407a;">
                    1
                </span>
            </a>
            
        </div>
    </div>
</div>


            </aside>

            <main class="main-content flex-grow-1 flex-shrink-1 d-flex flex-column overflow-x-hidden">
                





    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/%E8%AE%A9%20QMediaPlayer%20%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86.html"><i class="bi bi-box-arrow-up-right me-1"></i>让 QMediaPlayer 使用代理</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2025-02-21 22:57:25+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="1">
            <h1>让 QMediaPlayer 使用代理</h1>
<h2>QMediaPlayer 使用简介</h2>
<p>使用 <code>QMediaPlayer::setSource</code> 设置媒体源，即可进行播放：</p>
<pre><code class="language-cpp">player = new QMediaPlayer;
audioOutput = new QAudioOutput;
player-&gt;setAudioOutput(audioOutput);
connect(player, &amp;QMediaPlayer::positionChanged, this, &amp;MediaExample::positionChanged);
player-&gt;setSource(QUrl(&quot;https://vjs.zencdn.net/v/oceans.mp4&quot;));
audioOutput-&gt;setVolume(50);
player-&gt;play();
</code></pre>
<blockquote>
<p>上述代码使用 Qt6，Qt6 对 Multimedia 模块做了较大改动，与 Qt5 不兼容。</p>
</blockquote>
<h2>问题描述</h2>
<p><code>QMediaPlayer</code> 在播放网络源时，会预先加载一段时间，然后开始播放，预先加载的部分是流畅的，但如果网速慢于播放速度后续就会产生卡顿。</p>
<p>上述示例中使用的视频源来自 <a href="https://github.com/videojs/video.js">video.js</a>，播放时卡顿非常严重，经分析应是网速太慢导致的。</p>
<h2>应用代理无效</h2>
<p>通过 <code>QNetworkProxy::setApplicationProxy</code> 可以设置应用程序的全局代理，相应的 <code>QNetworkProxy::applicationProxy</code> 可以查看应用程序的全局代理。</p>
<blockquote>
<p>当系统设置了代理是，Qt 会自动设置应用代理，通过 <code>QNetworkProxy::applicationProxy</code> 查看即可可以确认这一点，不需要手动设置。</p>
</blockquote>
<p>但经过测试，<code>QMediaPlayer</code> 完全无视了应用代理，仍然卡顿。</p>
<h2>解决办法</h2>
<h3>手动使用 QtNetwork 设置代理并请求数据源</h3>
<p>可以手动使用 <code>QNetworkAccessManager</code> 请求网络源，并将返回的 <code>QNetworkReply</code> 设为 <code>QMediaPlayer</code> 的源：</p>
<pre><code class="language-cpp">manager = new QNetworkAccessManager;
manager.setProxy(QNetworkProxy()); // QNetworkAccessManager 会使用应用代理，这行可省略
reply = manager-&gt;get(QNetworkRequest(QUrl(&quot;https://vjs.zencdn.net/v/oceans.mp4&quot;)));

player-&gt;setSourceDevice(reply);
player-&gt;play();
</code></pre>
<h3>预加载</h3>
<p>上述示例并不能直接运行，因为返回时 <code>QNetworkReply</code> 还没有拿到数据。而 <code>QMediaPlayer</code> 不支持阻塞式读取。</p>
<p>因此需要等待 <code>QNetworkReply</code> 预加载一部分数据后再将其设为 <code>QMediaPlayer</code> 的数据源。</p>
<pre><code class="language-cpp">#define PRELOAD_SIZE 1024 * 1024

manager = new QNetworkAccessManager;
manager.setProxy(QNetworkProxy()); // QNetworkAccessManager 会使用应用代理，这行可省略
reply = manager-&gt;get(QNetworkRequest(QUrl(&quot;https://vjs.zencdn.net/v/oceans.mp4&quot;)));

// 等待 readyRead 并检查数据长度，达到一定的数据量时开始播放
connect(reply, &amp;QNetworkReply::readyRead, [reply, player](){
    if (reply-&gt;size() &gt;= PRELOAD_SIZE)
    {
        player-&gt;setSourceDevice(reply);
        player-&gt;play();
        disconnect(reply, &amp;QNetworkReply::readyRead); // 断开与 readyRead 信号连接的所有槽
    }
});

// 如果媒体源非常小，总数据两都小于 PRELOAD_SIZE，则在 finished 触发时开始播放
connect(reply, &amp;QNetworkReply::finished, [reply, player](){
    if (reply-&gt;size() &gt;= PRELOAD_SIZE)
    {
        player-&gt;setSourceDevice(reply);
        player-&gt;play();
        disconnect(reply, &amp;QNetworkReply::finished); // 断开与 finished 信号连接的所有槽
    }
});
</code></pre>
<h3>流媒体</h3>
<p>对于 m3u8 之类的流媒体，实际数据被切分为多个文件，m3u8 仅仅是文件索引。</p>
<p>使用 <code>QNetworkAccessManager</code> 发起请求时，仅仅获得了索引文件本身，需要手动解析并请求后续内容。</p>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/Qt%20Theme%20%E7%BA%AF%20qss%20%E7%9A%84%20Qt%20%E4%B8%BB%E9%A2%98.html"><i class="bi bi-box-arrow-up-right me-1"></i>Qt Theme 纯 qss 的 Qt 主题</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2025-02-20 15:29:19+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="2">
            <h1>Qt Theme 纯 qss 的 Qt 主题</h1>
<h2>简介</h2>
<p>源码地址：<a href="https://github.com/hubenchang0515/QtTheme/">https://github.com/hubenchang0515/QtTheme/</a></p>
<p><img src="https://github.com/hubenchang0515/QtTheme/raw/master/doc/image/dark.png" alt="预览" /></p>
<p>Qt Theme 是一个纯 qss 的 Qt 主题项目，能够极为简单对已有项目的风格进行改进。</p>
<p>支持 C++、PyQt5、PyQt6、PySide2、PySide6，并以 WebAssembly 的方式在 <a href="https://hubenchang0515.github.io/QtTheme/">GitHub Pages</a> 上发布。</p>
<h2>示例</h2>
<h3>安装</h3>
<p>这里演示一下在 Python 上的使用，首先进行安装：</p>
<pre><code class="language-bash">pip install QtTheme
</code></pre>
<h3>原生样式及代码</h3>
<p>让 Deep Seek 随便帮我写个界面作为示例：</p>
<p><img src="https://github.com/hubenchang0515/resource/blob/master/QtTheme/deepseek.png?raw=true" alt="deepseek" /></p>
<pre><code class="language-python">import sys
from PyQt5.QtWidgets import *
from PyQt5.QtGui import QPixmap, QFont
from PyQt5.QtCore import Qt, QTimer

class DemoWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle(&quot;PyQt Widget 演示界面&quot;)
        self.setGeometry(100, 100, 800, 600)
        
        # 创建中心widget和主布局
        central_widget = QWidget()
        self.setCentralWidget(central_widget)
        main_layout = QVBoxLayout(central_widget)

        # 添加功能区域
        self.create_input_section(main_layout)
        self.create_selection_section(main_layout)
        self.create_display_section(main_layout)
        self.create_progress_section(main_layout)
        
        # 添加状态栏
        self.statusBar().showMessage(&quot;就绪&quot;)

        # 初始化进度条
        self.progress_value = 0
        self.update_progress()

    def create_input_section(self, layout):
        group = QGroupBox(&quot;输入控件&quot;)
        grid = QGridLayout()

        # 文本输入
        self.line_edit = QLineEdit()
        self.line_edit.setPlaceholderText(&quot;单行文本输入...&quot;)
        grid.addWidget(QLabel(&quot;单行文本:&quot;), 0, 0)
        grid.addWidget(self.line_edit, 0, 1)

        # 多行文本
        self.text_edit = QTextEdit()
        self.text_edit.setPlaceholderText(&quot;多行文本输入...&quot;)
        grid.addWidget(QLabel(&quot;多行文本:&quot;), 1, 0)
        grid.addWidget(self.text_edit, 1, 1)

        # 数字输入
        self.spin_box = QSpinBox()
        self.spin_box.setRange(0, 100)
        grid.addWidget(QLabel(&quot;数字输入:&quot;), 2, 0)
        grid.addWidget(self.spin_box, 2, 1)

        group.setLayout(grid)
        layout.addWidget(group)

    def create_selection_section(self, layout):
        group = QGroupBox(&quot;选择控件&quot;)
        hbox = QHBoxLayout()

        # 复选框
        vbox = QVBoxLayout()
        self.check1 = QCheckBox(&quot;选项1&quot;)
        self.check2 = QCheckBox(&quot;选项2&quot;)
        vbox.addWidget(self.check1)
        vbox.addWidget(self.check2)
        hbox.addLayout(vbox)

        # 单选框
        vbox = QVBoxLayout()
        self.radio1 = QRadioButton(&quot;单选1&quot;)
        self.radio2 = QRadioButton(&quot;单选2&quot;)
        self.radio1.setChecked(True)
        vbox.addWidget(self.radio1)
        vbox.addWidget(self.radio2)
        hbox.addLayout(vbox)

        # 下拉列表
        self.combo = QComboBox()
        self.combo.addItems([&quot;选项A&quot;, &quot;选项B&quot;, &quot;选项C&quot;])
        hbox.addWidget(self.combo)

        group.setLayout(hbox)
        layout.addWidget(group)

    def create_display_section(self, layout):
        group = QGroupBox(&quot;显示控件&quot;)
        hbox = QHBoxLayout()

        # 标签
        self.label = QLabel(&quot;这是一个标签&quot;)
        self.label.setAlignment(Qt.AlignCenter)
        self.label.setStyleSheet(&quot;border: 1px solid gray; padding: 10px;&quot;)
        hbox.addWidget(self.label)

        # 图片显示
        pixmap = QPixmap(100, 50)
        pixmap.fill(Qt.blue)
        image_label = QLabel()
        image_label.setPixmap(pixmap)
        hbox.addWidget(image_label)

        # 列表控件
        self.list_widget = QListWidget()
        self.list_widget.addItems([&quot;项目1&quot;, &quot;项目2&quot;, &quot;项目3&quot;])
        hbox.addWidget(self.list_widget)

        group.setLayout(hbox)
        layout.addWidget(group)

    def create_progress_section(self, layout):
        group = QGroupBox(&quot;进度控件&quot;)
        vbox = QVBoxLayout()

        # 进度条
        self.progress_bar = QProgressBar()
        self.progress_bar.setValue(0)
        vbox.addWidget(self.progress_bar)

        # 滑块
        self.slider = QSlider(Qt.Horizontal)
        self.slider.setRange(0, 100)
        self.slider.valueChanged.connect(self.on_slider_changed)
        vbox.addWidget(self.slider)

        # 控制按钮
        btn_layout = QHBoxLayout()
        self.start_btn = QPushButton(&quot;开始进度&quot;)
        self.start_btn.clicked.connect(self.start_progress)
        self.reset_btn = QPushButton(&quot;重置&quot;)
        self.reset_btn.clicked.connect(self.reset_progress)
        btn_layout.addWidget(self.start_btn)
        btn_layout.addWidget(self.reset_btn)

        vbox.addLayout(btn_layout)
        group.setLayout(vbox)
        layout.addWidget(group)

    def on_slider_changed(self, value):
        self.progress_bar.setValue(value)
        self.statusBar().showMessage(f&quot;滑块值: {value}&quot;)

    def start_progress(self):
        self.timer = QTimer()
        self.timer.timeout.connect(self.update_progress)
        self.timer.start(100)

    def update_progress(self):
        self.progress_value += 1
        if self.progress_value &gt; 100:
            self.timer.stop()
            return
        self.progress_bar.setValue(self.progress_value)
        self.slider.setValue(self.progress_value)

    def reset_progress(self):
        self.progress_value = 0
        self.progress_bar.setValue(0)
        self.slider.setValue(0)

if __name__ == &quot;__main__&quot;:
    app = QApplication(sys.argv)
    window = DemoWindow()
    window.show()
    sys.exit(app.exec_())
</code></pre>
<p>运行起来看看：</p>
<p><img src="https://github.com/hubenchang0515/resource/blob/master/QtTheme/%E5%8E%9F%E7%94%9Fui.png?raw=true" alt="native ui" /></p>
<h3>设置全局样式</h3>
<p>导入 QtTheme，并通过 Qt 资源系统读取并设置样式即可：</p>
<pre><code class="language-python">from PyQt5.QtCore import QFile
import QtTheme.PyQt5

class DemoWindow(QMainWindow):
    def __init__(self):
        # 省略...

        qss = QFile(&quot;:/QtTheme/theme/Flat/Dark/Blue/Pink.qss&quot;)
        qss.open(QFile.OpenModeFlag.ReadOnly)
        self.setStyleSheet(qss.readAll().data().decode())
</code></pre>
<p><img src="https://github.com/hubenchang0515/resource/blob/master/QtTheme/dark-ui.png?raw=true" alt="dark ui" /></p>
<h3>设置颜色</h3>
<p>最后根据需要，通过 <code>QWidget.setProperty</code> 对 widgets 设置颜色：</p>
<pre><code class="language-python">    def create_progress_section(self, layout):
        # 省略 ...
        self.start_btn.setProperty(&quot;Color&quot;, &quot;Primary&quot;)
        self.reset_btn.setProperty(&quot;Color&quot;, &quot;Danger&quot;)
</code></pre>
<p><img src="https://github.com/hubenchang0515/resource/blob/master/QtTheme/color-ui.png?raw=true" alt="color ui" /></p>
<h3>导出资源</h3>
<p>你也可以不安装 <code>QtTheme</code>，而是通过 <a href="https://hubenchang0515.github.io/QtTheme/">在线页面</a> 导出资源文件，
通过 <a href="https://doc.qt.io/qt-6/rcc.html">RCC</a> 将其加入你的项目：</p>
<pre><code class="language-bash">pyrcc5 -o resource.py QtTheme.qrc
</code></pre>
<p>只需要修改导入方式，其余代码一致:</p>
<pre><code class="language-python">from PyQt5.QtCore import QFile
import resource   # 改为导入生成的 resource.py

class DemoWindow(QMainWindow):
    def __init__(self):
        # 省略...

        qss = QFile(&quot;:/QtTheme/theme/Flat/Dark/Blue/Pink.qss&quot;)
        qss.open(QFile.OpenModeFlag.ReadOnly)
        self.setStyleSheet(qss.readAll().data().decode())

</code></pre>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/QAudioOutput%20%E6%97%A0%E6%B3%95%E6%92%AD%E6%94%BE%E5%A3%B0%E9%9F%B3%E7%9A%84%E9%97%AE%E9%A2%98.html"><i class="bi bi-box-arrow-up-right me-1"></i>QAudioOutput 无法播放声音的问题</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 21:18:31+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="3">
            <h1>QAudioOutput 无法播放声音的问题</h1>
<p>在 Windows 上使用 MSVC 编译的 Qt 程序，无法播放声音，<code>QAudioDeviceInfo::availableDevices</code> 返回空列表。</p>
<p>这是因为没能正确加载 Qt 插件。需要将 <code>Qt\msvc2017_64\plugins</code> 目录下的 audio 目录复制到可执行文件所在目录。</p>
<p>使用 <code>windeployqt</code> 部署后即可正确运行。</p>
<p>插件加载正确后，仍然发生无声音的问题，且 Qt 无任何报错。通过 QAudioDeviceInfo 查看支持的音频格式为：</p>
<pre><code>(&quot;audio/pcm&quot;)
(8000, 11025, 16000, 22050, 32000, 44100, 48000, 88200, 96000, 192000)
(8, 16, 24, 32, 48, 64)
(LittleEndian)
(SignedInt, UnSignedInt, Float)
</code></pre>
<p>程序设置的音频格式为 <strong>32 位、小端、浮点数</strong>，在支持的范围内。</p>
<p><a href="https://stackoverflow.com/questions/15594180/qaudiooutput-in-qt5-is-not-producing-any-sound">这个问题</a>上的回答提到:</p>
<blockquote>
<p>Qt 音频在 Windows 上，8 位数据只支持 UnSignedInt，16 位数据支持 SignedInt</p>
</blockquote>
<p>但是没有提到 float 类型，怀疑可能不支持，改用 16 位 SignedInt 后可以正常播放。</p>
<blockquote>
<p>另外，使用其支持列表返回的 64 位会报错，可以判断支持列表是假的。</p>
</blockquote>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/QCustomPlot%20%E5%90%AF%E7%94%A8%20OpenGL.html"><i class="bi bi-box-arrow-up-right me-1"></i>QCustomPlot 启用 OpenGL</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 21:18:31+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="4">
            <h1>QCustomPlot 启用 OpenGL</h1>
<p>编译时添加预编译宏 <code>QCUSTOMPLOT_USE_OPENGL</code>，用绘图的 <code>QCustomPlot</code> 子类调用 <code>setOpenGl(true)</code>，并链接 <code>OpenGL32</code></p>
<blockquote>
<p>在 Windows 上使用 <code>OpenGL32</code> 存在很严重的性能问题，可以改为使用 <a href="https://github.com/FreeGLUTProject/freeglut">freeglut</a></p>
</blockquote>
<h2>图像错乱问题</h2>
<p>修改 <code>QCPPaintBufferGlFbo::draw</code>，添加上下文切换的代码。</p>
<pre><code class="language-c++">void QCPPaintBufferGlFbo::draw(QCPPainter *painter) const
{
  if (!painter || !painter-&gt;isActive())
  {
    qDebug() &lt;&lt; Q_FUNC_INFO &lt;&lt; &quot;invalid or inactive painter passed&quot;;
    return;
  }
  if (!mGlFrameBuffer)
  {
    qDebug() &lt;&lt; Q_FUNC_INFO &lt;&lt; &quot;OpenGL frame buffer object doesn't exist, reallocateBuffer was not called?&quot;;
    return;
  }
  
  // 添加
  if (QOpenGLContext::currentContext() != mGlContext.data()) {
    mGlContext.data()-&gt;makeCurrent(mGlContext.data()-&gt;surface());
  }
  
  painter-&gt;drawImage(0, 0, mGlFrameBuffer-&gt;toImage());
}
</code></pre>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/%E7%BC%96%E8%AF%91%20Qt%20%E6%BA%90%E7%A0%81%EF%BC%8C%E6%B2%A1%E6%9C%89%E7%94%9F%E6%88%90%20libqxcb.so%20%E7%9A%84%E9%97%AE%E9%A2%98.html"><i class="bi bi-box-arrow-up-right me-1"></i>编译 Qt 源码，没有生成 libqxcb.so 的问题</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 21:18:31+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="5">
            <h1>编译 Qt 源码，没有生成 libqxcb.so 的问题</h1>
<p>Qt 通过不同的插件，在不同的平台上进行显示，例如:</p>
<ul>
<li><code>libqlinuxfb.so</code> 用于 Frame Buffer</li>
<li><code>libqxcb.so</code> 用于 X11</li>
<li><code>libqwayland-generic.so</code> 用于 Wayland</li>
</ul>
<p>构建 X11 插件需要依赖许多 xcb 的开发包，可以通过下面的命令安装:</p>
<p><strong>Qt 5.15.2</strong>:</p>
<pre><code class="language-bash">sudo apt install libfontconfig1-dev \
                 libfreetype6-dev \
                 libx11-dev \
                 libx11-xcb-dev \
                 libxext-dev \
                 libxfixes-dev \
                 libxi-dev \
                 libxrender-dev \
                 libxcb1-dev \
                 libxcb-glx0-dev \
                 libxcb-keysyms1-dev \
                 libxcb-image0-dev \
                 libxcb-shm0-dev \
                 libxcb-icccm4-dev \
                 libxcb-sync0-dev \
                 libxcb-xfixes0-dev \
                 libxcb-shape0-dev \
                 libxcb-randr0-dev \
                 libxcb-render-util0-dev \
                 libxcb-xinerama0-dev \
                 libxkbcommon-dev \
                 libxkbcommon-x11-dev
</code></pre>
<p><strong>Qt 6.5</strong>:</p>
<pre><code>sudo apt install libfontconfig1-dev \
                 libfreetype6-dev \
                 libx11-dev \
                 libx11-xcb-dev \
                 libxext-dev \
                 libxfixes-dev \
                 libxi-dev \
                 libxrender-dev \
                 libxcb1-dev \
                 libxcb-cursor-dev \
                 libxcb-glx0-dev \
                 libxcb-keysyms1-dev \
                 libxcb-image0-dev \
                 libxcb-shm0-dev \
                 libxcb-icccm4-dev \
                 libxcb-sync-dev \
                 libxcb-xfixes0-dev \
                 libxcb-shape0-dev \
                 libxcb-randr0-dev \
                 libxcb-render-util0-dev \
                 libxcb-util-dev \
                 libxcb-xinerama0-dev \
                 libxcb-xkb-dev \
                 libxkbcommon-dev \
                 libxkbcommon-x11-dev
</code></pre>
<p>安装后重新构建即可:</p>
<pre><code class="language-bash">rm config.cache
./configure -nomake examples -prefix /opt/qt-6.5.2 -opensource -confirm-license -release -xcb
make
make install
</code></pre>
<p>单独编译某个模块的命令为:</p>
<pre><code class="language-bash">make module-qtbase                     # 单独编译 qtbase
make module-qtbase-install_subtargets  # 单独安装 qtbase
</code></pre>
<p>另外，如果需要 OpenGL 的话，可以安装以下包:</p>
<pre><code class="language-bash">sudo apt install libgl1-mesa-dev \
                 libglu1-mesa-dev \
                 libx11-dev
</code></pre>
<blockquote>
<p>如果不需要 OpenGL 的话，在 configure 步骤添加  <code>-no-opengl</code> 选项即可。</p>
</blockquote>
<p>如果需要使用 SSL 的话，可以安装以下包:</p>
<pre><code class="language-bash">sudo apt install libssl-dev \
                 openssl
</code></pre>
<blockquote>
<p>如果不需要 OpenGL 的话，在 configure 步骤添加  <code>-no-ssl</code> 选项即可。</p>
</blockquote>
<p><strong>缓存问题</strong>:</p>
<p>执行过 configure 之后再安装依赖，再次执行 configure 仍会提示缺少依赖，可以删除 <code>config.cache</code> 来解决。</p>
<p><strong>查找路径问题</strong>:</p>
<p>执行 configure 时可以使用 <code>-I</code> 和 <code>-L</code> 选项添加查找路径。</p>
<p>参考:</p>
<ul>
<li><a href="https://doc.qt.io/qt-5/linux-requirements.html">Qt for X11 Requirements</a></li>
</ul>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/QObject%20%E4%B8%8E%20dllimport%20%E7%9A%84%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98.html"><i class="bi bi-box-arrow-up-right me-1"></i>QObject 与 dllimport 的相关问题</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 20:03:48+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="6">
            <h1>QObject 与 dllimport 的相关问题</h1>
<p>Qt 的元对象编译（MOC）系统会根据标记了 <code>Q_OBJECT</code> 的类生成代码。由于类通常在头文件中，因此通常需要将头文件加入编译。</p>
<pre><code class="language-cmake">add_library(lib SHARED lib.h lib.cpp)
</code></pre>
<p>在 Windows 上引用 lib 时，可能会遇到 staticMetaObject 符号未定义的错误。</p>
<pre><code class="language-cmake">add_executable(demo main.cpp)
</code></pre>
<p>即使创建动态库时，将 <code>CMAKE_EXPORT_ALL_SYMBOLS</code> 设为 <code>ON</code> 也不行。</p>
<pre><code class="language-cmake">set(CMAKE_EXPORT_ALL_SYMBOLS ON)
add_library(lib SHARED lib.h lib.cpp)
</code></pre>
<p>这是因为只有函数符号可以自动导入，而staticMetaObject 是静态数据成员，全局数据必须通过 __declspec(dllimport) 手动导入。</p>
<p>参考 <a href="https://cmake.org/cmake/help/latest/prop_tgt/WINDOWS_EXPORT_ALL_SYMBOLS.html">CMake 文档</a>。</p>
<p>正确的解决办法是声明 dllexport 和 dllimport</p>
<pre><code class="language-c++">#ifdef BUILD_SHARED
    #define DLL_EXPORT __declspec(dllexport)
#else
    #define DLL_EXPORT __declscpe(dllimport)
#endif

class DLL_EXPORT XXX : public QObject
{
    Q_OBJECT
};
</code></pre>
<p>不清楚这个机制的人可能会在外部项目中将 lib.h 加入编译，这样错误也会消失，因为 lib.h 重新 moc 并编译了一份。</p>
<pre><code class="language-cmake">add_executable(demo main.cpp lib.h)
</code></pre>
<p>但这是错误的解决办法，这将导致外部项目和库中的 staticMetaObject 是不同的对象。</p>
<p>并且，如果引用的头文件中已经声明了 <code>DLL_EXPORT</code>，同时外部项目不是 <code>BUILD_SHARED</code>（例如构建可执行程序）。此时 <code>DLL_EXPORT</code> 将被解析为 <code>__declscpe(dllimport)</code>，从而导致头文件报 <code>不允许 dllimport 静态数据成员 staticMetaObject</code> 的错误。</p>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/Qt%20%E5%B8%83%E5%B1%80%E4%B8%8D%E6%9B%B4%E6%96%B0%E7%9A%84%E9%97%AE%E9%A2%98.html"><i class="bi bi-box-arrow-up-right me-1"></i>Qt 布局不更新的问题</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 20:03:48+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="7">
            <h1>Qt 布局不更新的问题</h1>
<h2>修改 QWidget</h2>
<p>在 QWidget 已经加入布局之后，修改其大小，布局不会自动更新。需要调用 <code>QWidget::updateGeometry</code> 方法。</p>
<blockquote>
<p>类似的，修改子布局时需要调用 <code>QLayout::updateGeometry</code> 方法。</p>
</blockquote>
<h2>修改 QSpacerItem</h2>
<p>在 QSpacerItem 已经加入布局之后，修改其大小，布局不会自动更新。需要调用 <code>QLayout::invalidate</code> 方法。</p>
<p>另外还可以调用 <code>QWidget::adjustSize</code> 方法调整大小.</p>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/Qt%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97.html"><i class="bi bi-box-arrow-up-right me-1"></i>Qt 日志模块</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 20:03:48+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="8">
            <h1>Qt 日志模块</h1>
<p>旧的方式:</p>
<pre><code class="language-cpp">#include &lt;QDebug&gt;

qDebug() &lt;&lt; &quot;hello world&quot;
</code></pre>
<p>现在默认所有日志都不打印，因此这种方式看不到打印</p>
<pre><code>QT_LOGGING_RULES=&quot;*.debug=false&quot;
</code></pre>
<p>新的方式:</p>
<pre><code class="language-cpp">#include &lt;QLoggingCategory&gt;

QLoggingCategory category(&quot;my.module&quot;);
qCDebug(category) &lt;&lt; &quot;hello world&quot;;
</code></pre>
<p>需要配置打印哪些模块的日志</p>
<pre><code>QT_LOGGING_RULES=&quot;*.debug=false;my.module.debug=true&quot;
</code></pre>
<p>其中日志类型支持 <code>debug</code>, <code>info</code>, <code>warning</code>, <code>critical</code> 四种类型</p>
<p><code>qDebug</code> 等旧接口所属模块名为 <code>default</code>, 因此如下配置可以使旧的方式打印可见:</p>
<pre><code>QT_LOGGING_RULES=&quot;*.debug=false;default.debug=true&quot;
</code></pre>
<p>QtQuick/QML 中 <code>console.log</code> 属于 <code>qml</code> 或 <code>js</code> 模块，因此使用如下配置可以使其打印可见:</p>
<pre><code>QT_LOGGING_RULES=&quot;*.debug=false;qml.debug=true&quot;
</code></pre>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/Qt%20%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E6%89%93%E5%BC%80%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98.html"><i class="bi bi-box-arrow-up-right me-1"></i>Qt 资源文件打开失败的问题</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 20:03:48+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="9">
            <h1>Qt 资源文件打开失败的问题</h1>
<p>首先，Qt 的资源文件需要使用 <code>Q_INIT_RESOURCE</code> 宏进行初始化，参数为 <code>qrc</code> 文件的文件名，例如:</p>
<pre><code class="language-c++">Q_INIT_RESOURCE(theme);   // 初始化 theme.qrc
Q_INIT_RESOURCE(icon);    // 初始化 icon.qrc
</code></pre>
<p>并且，这个宏必须在全局命名空间下调用，例如:</p>
<pre><code class="language-c++">static inline void initResource()
{
    Q_INIT_RESOURCE(theme);   // 初始化 theme.qrc
    Q_INIT_RESOURCE(icon);    // 初始化 icon.qrc
}

namespace DemoNamespace
{

class DemoClass
{

public:
    DemoClass()
    {
        initResource(); // 调用初始化函数
    }

};

};
</code></pre>
<p>并且，可以使用 <code>Q_CLEANUP_RESOURCE</code> 宏来显式删除资源。</p>
<blockquote>
<p><code>Q_INIT_RESOURCE</code> 仅在将资源构建为静态库时是必须的，在构建动态库和应用程序中时可以省略。</p>
</blockquote>
<p>但是我遇到的是另一个问题 —— <strong>Qt 的资源集合文件不能重名</strong></p>
<p>在库中创建了名为 <code>theme.qrc</code> 的资源集合文件，之后在应用程序中再次创建一个名为 <code>theme.qrc</code> 的资源集合文件。库的 <code>theme.qrc</code> 会失效。</p>
<blockquote>
<p>这个问题仅在 Linux 上存在，而在 Windows 上不存在。因此无法确定是 Feature 还是 Bug。</p>
</blockquote>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



    
        
        <div class="d-flex flex-column">
    <div class="no-print article-header d-flex px-1 text-nowrap" style="gap: 16px">
        <a class="fs-6 overflow-x-hidden text-white" href="/Phosphophyllite/articles/Qt/Ubuntu%20%E4%B8%8A%E9%85%8D%E7%BD%AE%20QtQuick%28QML%29%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html"><i class="bi bi-box-arrow-up-right me-1"></i>Ubuntu 上配置 QtQuick(QML) 开发环境</a>
        <div style="flex-grow: 1; flex-shrink: 1;"></div>
        <div class="fs-6"><i class="bi bi-calendar"></i><span class="time ms-1">2024-12-18 20:03:48+08:00</span></div>
    </div>

    <div class="d-flex overflow-hidden" style="max-height: 300px;">
        <div class="no-print article-border-left"></div>
        <div class="article-preview markdown-body flex-grow-1 p-2" tabindex="10">
            <h1>Ubuntu 上配置 QtQuick/QML 开发环境</h1>
<p>安装以下包:</p>
<pre><code>sudo apt install qtbase5-dev              # Qt5 基础开发包
sudo apt install qtquickcontrols2-5-dev   # QtQuick 基础开发包
sudo apt install qtdeclarative5-dev       # Qt5 的 CMake 模块

sudo apt install qtcreator                # Qt Creator
sudo apt install qttools5-dev             # Qt5 工具，包含 Qt5Designer、Qt5LinguistTools 等
sudo apt install qmlscene                 # QML 预览工具
</code></pre>
<p>QML 导入失败时，表示没有安装对应的模块，deb 包名为 <code>qml-module-*</code>。</p>
<p>例如 <code>QtQuick.Dialogs</code> 的 deb 包名为 <code>qml-module-qtquick-dialogs</code>。</p>
<h1>遇到的一些问题</h1>
<p>最初安装的包:</p>
<pre><code class="language-bash">sudo apt install qtbase5-dev
sudo apt install qtquickcontrols2-5-dev
sudo apt install qtcreator
</code></pre>
<h2>执行 CMake 失败</h2>
<pre><code>  Could not find a package configuration file provided by &quot;Qt5Quick&quot; 
  with any of the following names:

    Qt5QuickConfig.cmake
    qt5quick-config.cmake
</code></pre>
<p>原因: 没有安装 Qt 的 CMake 模块<br />
解决: <code>sudo apt install qtdeclarative5-dev</code></p>
<pre><code>  Could not find a package configuration file provided by &quot;Qt5LinguistTools&quot;
  with any of the following names:

    Qt5LinguistToolsConfig.cmake
    qt5linguisttools-config.cmake
</code></pre>
<p>原因: 没有安装 Qt5 Linguist Tools 的 CMake 模块
解决: <code>sudo apt install qttools5-dev</code></p>
<h2>导入 QtQuick.Controls 2 失败</h2>
<pre><code>QQmlApplicationEngine failed to load component
qrc:/main.qml:2:1: plugin cannot be loaded for module &quot;QtQuick.Controls&quot;: Cannot protect module QtQuick.Controls 2 as it was never registered
</code></pre>
<p>原因: 没有安装 QtQuick.Controls 2 的运行时环境<br />
解决: <code>sudo apt install qml-module-qtquick-controls2</code></p>
<h2>导入 QtQuick.Dialogs 失败</h2>
<pre><code>module &quot;QtQuick.Dialogs&quot; is not installed
</code></pre>
<p>原因: 没有安装 QtQuick.Dialogs
解决: <code>sudo apt install qml-module-qtquick-dialogs</code></p>

        </div>
        <div class="no-print article-border-right"></div>
    </div>

    <div class="no-print article-border-bottom"></div>
</div>
    



<div>
    <ul class="pagination float-end">
        
        <li class="page-item disabled">
            <a class="page-link" href="#"><i class="bi bi-chevron-double-left"></i></a>
        </li>
        

        
            
            
        
            
            
        
            
            <li class="page-item active">
                <a class="page-link" href="/Phosphophyllite/categories/Qt-1.html">1</a>
            </li>
            
        
            
            
        
            
            
        

        
        <li class="page-item disabled">
            <a class="page-link" href="#"><i class="bi bi-chevron-double-right"></i></a>
        </li>
        
    </ul>
</div>


            </main>

            <aside class="no-print right-side flex-shrink-0 d-flex flex-column">
            

<div class="card">
    <img src="https://github-readme-stats.vercel.app/api?username=hubenchang0515&theme=transparent&hide_border=true&show_icons=true&card_width=400"/>
</div>

<div class="card">
    <img src="https://github-readme-stats.vercel.app/api/top-langs/?username=hubenchang0515&layout=compact&theme=transparent&hide_border=true&card_width=400&langs_count=32&size_weight=0.1&count_weight=0.9&hide=cmake%2Cqmake%2Cmakefile%2Cshell%2Cobjective-c"/>
</div>

<div class="card">
    <div class="card-body">
        <h4 class="card-title">导航</h4>
        <h6 class="card-subtitle mb-2 text-muted">Navigation</h6>
        <div class="d-flex flex-wrap" style="gap: 8px;">
            
            <a class="link-info" href="https://hubenchang0515.github.io/" target="_blank"><i class="bi bi-link-45deg"></i> 主页</a>
            
            <a class="link-info" href="https://hubenchang0515.github.io/primers/" target="_blank"><i class="bi bi-link-45deg"></i> Primers 编程教程</a>
            
            <a class="link-info" href="https://hubenchang0515.github.io/QtTheme/" target="_blank"><i class="bi bi-link-45deg"></i> QtTheme</a>
            
            <a class="link-info" href="https://hubenchang0515.github.io/shift/" target="_blank"><i class="bi bi-link-45deg"></i> Shift 在线编程</a>
            
            <a class="link-info" href="https://hubenchang0515.github.io/moe-tools/" target="_blank"><i class="bi bi-link-45deg"></i> 萌萌工具箱</a>
            
            <a class="link-info" href="https://hubenchang0515.github.io/friends/" target="_blank"><i class="bi bi-link-45deg"></i> 友情链接</a>
            
        </div>
    </div>
</div>

<div class="card sticky">
    <div class="card-body">
        <h4 class="card-title">最近文章</h4>
        <h6 class="card-subtitle mb-2 text-muted">Recent Articles</h6>
        <ul>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/React/MUI%20%E9%9B%86%E6%88%90%20nextjs.html">MUI 集成 nextjs</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/MySQL/MySQL%20%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95.html">MySQL 全文索引</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/%E5%9C%A8%20eu.org%20%E6%B3%A8%E5%86%8C%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D.html">在 eu.org 注册免费域名</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/MySQL/MySQL%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4.html">MySQL 数据库基础命令</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/MySQL/MySQL%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9D%E5%A7%8B%E5%8C%96.html">MySQL 数据库初始化</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/Minecraft/%E4%BD%BF%E7%94%A8%20Tan90-Proxy%20%E4%BB%A3%E7%90%86%20Minecraft%20%E6%9C%8D%E5%8A%A1%E5%99%A8.html">使用 Tan90-Proxy 代理 Minecraft 服务器</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/Minecraft/Minecraft%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B%E8%BD%BD%E9%A1%B5%E5%9C%B0%E5%9D%80.html">Minecraft 服务器下载页地址</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/nginx/nginx%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE.html">nginx 常用命令与基础配置</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/Linux%20%E5%91%BD%E4%BB%A4%E4%B8%8E%E9%85%8D%E7%BD%AE/%E5%88%B6%E4%BD%9C%20deb%20%E5%8C%85.html">制作 deb 包</a>
            </li>
            
            <li>
                <a class="link-info" href="/Phosphophyllite/articles/Windows%20%E5%91%BD%E4%BB%A4%E4%B8%8E%E9%85%8D%E7%BD%AE/Windows%20%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E7%A8%8B%E5%BA%8F.html">Windows 注册表中添加自己的程序</a>
            </li>
            
        </ul>
    </div>
</div>


            </aside>
        </div>

        <footer class="no-print">
            

<div class="card" style="border-radius: 0;">
    <p class="github-brief card-text" style="margin: auto;">
        Powered by <i class="bi bi-arrow-through-heart-fill"></i> <a class="card-link link-success" href="https://github.com/hubenchang0515/Phosphophyllite" target="_blank">Phosphophyllite</a>
    </p>
</div>


        </footer>

        

<script>
    fetchUserInfo("hubenchang0515");
    scanTime();
</script>


    </body>
</html>